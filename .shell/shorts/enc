#!/usr/bin/env python3
import sys
import subprocess
import os

if len(sys.argv) != 3:
    print("Usage: python3 encrypt_zpaq.py <file_or_folder_path> <password>")
    sys.exit(1)

path = sys.argv[1]
key = sys.argv[2]

if not os.path.exists(path):
    print(f"Error: Path '{path}' does not exist.")
    sys.exit(1)

archive_name = os.path.basename(path.rstrip("/\\")) + ".zpaq"

try:
    subprocess.run(["zpaq", "a", archive_name, path, "-key", key], check=True)
    print(f"Encrypted archive created: {archive_name}")
except subprocess.CalledProcessError:
    print("Error: Failed to create archive.")
    sys.exit(1)
