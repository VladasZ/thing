#!/usr/bin/env python3

import sys
import subprocess
import os

cwd = os.getcwd()

os.chdir('..')
subprocess.run(['cargo', 'build'], check=True)
os.chdir(cwd)

logs_dir = os.path.join(os.getcwd(), 'logs')
for filename in os.listdir(logs_dir):
    if filename != '.gitkeep':
        os.remove(os.path.join(logs_dir, filename))

feature = sys.argv[-1]

command = ['bundle', 'exec', 'cucumber', 'features/' + feature + '.feature']

os.environ['RUST_TARGET'] = 'debug'
subprocess.run(command, check=True)
