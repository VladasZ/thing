
# Tells us if the host system is an Apple Silicon Mac running Rosetta
def is_arm64()
  `uname -m` == "arm64" || `/usr/bin/arch -64 sh -c "sysctl -in sysctl.proc_translated"`.strip() == "0"
end

Vagrant.configure("2") do |config|

  config.ssh.forward_agent = true

  config.vm.provider "virtualbox" do |v|
    v.memory = 2048 * 2
    v.cpus = 4
  end

  config.vm.define "lin" do |lin|
    if is_arm64()
      lin.vm.box = "jharoian3/ubuntu-22.04-arm64"
    else
      lin.vm.box = "generic/ubuntu2204"
    end
  end

  config.vm.define "win" do |win|
    if is_arm64()
      win.vm.box = "nullx/windows-arm64"
    else
      lin.vm.box = "gusztavvargadr/visual-studio"
    end
  end

end

# vagrant plugin install vagrant-parallels